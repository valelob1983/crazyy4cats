<% if notice %>
  <p class="alert alert-success"><%= notice %></p>
<% end %>

<div class="container mt-5">
  <div class="row">
    <div class="col-md-12">
      <!-- Marco de la publicación -->
      <div class="content-frame d-flex justify-content-between align-items-center p-4 mb-4 shadow-sm rounded" style="border: 1px solid #ccc;">
        <!-- Contenido de la publicación -->
        <div>
          <p><strong>Título:</strong> <%= @publication.title %></p>
          <p><strong>Contenido:</strong> <%= @publication.content %></p>
          <p><strong>Creado por:</strong> <%= @publication.user.name %></p>
        </div>

        <!-- Iconos de acción -->
        <div class="action-icons d-flex flex-column align-items-center">
          <!-- Editar publicación -->
          <%= link_to edit_publication_path(@publication), class: "text-primary mb-3" do %>
            <i class="fas fa-edit fa-2x" title="Editar"></i>
          <% end %>

          <!-- Volver a publicaciones -->
          <%= link_to publications_path, class: "text-secondary mb-3" do %>
            <i class="fas fa-arrow-left fa-2x" title="Volver"></i>
          <% end %>

          <!-- Botón de eliminación -->
          <%= button_to publication_path(@publication), method: :delete, data: { confirm: '¿Estás seguro de que deseas eliminar esta publicación?' }, class: 'btn btn-danger btn-sm d-flex align-items-center justify-content-center shadow-lg transition-all mt-2' do %>
            <i class="fas fa-trash-alt mr-2"></i> Eliminar
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Comentarios -->
  <h2>Comentarios</h2>

  <!-- Mostrar comentarios existentes -->
  <% @publication.user_comments.each do |comment| %>
    <div class="comment mb-3 p-3 border rounded">
      <p><strong><%= comment.user ? comment.user.email : "Anónimo" %>:</strong> <%= comment.content %></p>
      
      <!-- Contadores de Likes y Dislikes -->
      <p>Likes: <%= comment.likes_count %> | Dislikes: <%= comment.dislikes_count %></p>
      
      <!-- Botones de Me gusta y No me gusta -->
      <div class="d-flex">
        <%= button_to 'Me gusta', like_publication_user_comment_path(@publication, comment), method: :post, class: "btn btn-success btn-sm d-inline-block mr-2 me-2" %>
        <%= button_to 'No me gusta', dislike_publication_user_comment_path(@publication, comment), method: :post, class: "btn btn-danger btn-sm d-inline-block" %>
      </div>
    </div>
  <% end %>

  <!-- Formulario para agregar un comentario -->
  <div class="mt-4">
    <%= form_with model: [@publication, @publication.user_comments.build], local: true do |form| %>
      <div class="form-group">
        <%= form.label :content, "Nuevo Comentario", class: "form-label" %>
        <%= form.text_area :content, class: "form-control" %>
      </div>
      
      <div class="actions mt-3">
        <%= form.submit "Agregar Comentario", class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
